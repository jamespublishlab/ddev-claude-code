#ddev-generated
hooks:
  pre-start:
    - exec-host: |
        echo "GH_TOKEN=$(gh auth token 2>/dev/null)" > .ddev/.env.tokens
        TOKEN=$(cat ~/.claude/setup-token 2>/dev/null || jq -r '.claudeAiOauth.accessToken // empty' ~/.claude/.credentials.json 2>/dev/null)
        if [ -n "$TOKEN" ]; then
          echo "CLAUDE_CODE_OAUTH_TOKEN=$TOKEN" >> .ddev/.env.tokens
        fi
  post-start:
    - exec: |
        # Ensure Claude Code skips onboarding (GitHub Issue #8938)
        # The Dockerfile seeds /etc/skel, but this covers existing users.
        if [ ! -f ~/.claude.json ]; then
          echo '{"hasCompletedOnboarding": true}' > ~/.claude.json
        fi
